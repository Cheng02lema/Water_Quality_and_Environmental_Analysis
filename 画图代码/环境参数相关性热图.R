# 安装必要的包（如果尚未安装）
install.packages("corrplot")

# 加载包
library(corrplot)

# 构建数据框
data <- data.frame(
  温度 = c(15.9, 18.2, 12.9, 17.7, 11.6, 15.8),
  DO = c(8.9, 7.19, 5.73, 6.92, 8.01, 6.04),
  pH = c(7.94, 7.92, 8.32, 8.04, 8.01, 8.11),
  COD = c(0.52, 0.6, 0.69, 0.46, 0.41, 0.54),
  石油烃 = c(0.49, 33.02, 0.95, 8.57, 5.07, 4.816),
  无机氮 = c(33.09, 64.4, 56.33, 43, 209.22, 118.76),
  叶绿素a = c(0.98, 0.12, 21.1, 1.76, 1.52, 2.17),
  磷酸盐 = c(7.74, 4, 4.57, 12.95, 2.5, 4.1),
  营养指数EI = c(0.130714286, 0.160714286, 0.162142857, 0.264642857, 0.644642857, 0.264642857),
  浮游动物生物量 = c(162.4535714, 216.3928571, 83.08892857, 19.43464286, 4586.0508, 60.20821429),
  浮游动物多样性 = c(1.763571429, 1.403571429, 1.865, 1.688214286, 0.3375, 0.714285714),
  浮游植物多样性指数 = c(1.578928571, 1.900714286, 1.625, 2.321785714, 2.5075, 0.615714286)
)

# 计算相关性矩阵
correlation_matrix <- cor(data, use = "complete.obs")

# 绘制相关性热图
corrplot(correlation_matrix, method = "circle", type = "full", tl.col = "black", tl.srt = 45,
         addCoef.col = "black", # 在圆圈中添加相关系数
         col = colorRampPalette(c("blue", "white", "red"))(200), # 使用蓝-白-红颜色表示相关性强弱
         number.cex = 0.8, # 控制相关系数字体大小
         mar = c(0, 0, 1, 0), # 控制边距
         title = "环境参数相关性热图")
