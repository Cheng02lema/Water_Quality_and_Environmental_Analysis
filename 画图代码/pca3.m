% 创建数据矩阵（基于提供的数据）
data = [
    15.9, 8.9, 7.94, 0.52, 0.49, 33.09, 0.98, 7.74, 0.130714286, 162.4535714, 1.763571429, 1.578928571;
    18.2, 7.19, 7.92, 0.6, 33.02, 64.4, 0.12, 4, 0.160714286, 216.3928571, 1.403571429, 1.900714286;
    12.9, 5.73, 8.32, 0.69, 0.95, 56.33, 21.1, 4.57, 0.162142857, 83.08892857, 1.865, 1.625;
    17.7, 6.92, 8.04, 0.46, 8.57, 43, 1.76, 12.95, 0.264642857, 19.43464286, 1.688214286, 2.321785714;
    11.6, 8.01, 8.01, 0.41, 5.07, 209.22, 1.52, 2.5, 0.644642857, 4586.0508, 0.3375, 2.5075;
    15.8, 6.04, 8.11, 0.54, 4.816, 118.76, 2.17, 4.1, 0.264642857, 60.20821429, 0.714285714, 0.615714286
];

% 定义变量名称和样本标签
var_names = {'温度', 'DO', 'pH', 'COD', '石油烃', '无机氮', '叶绿素a', '磷酸盐', '营养指数EI', '浮游动物生物量', '浮游动物多样性', '浮游植物多样性指数'};
time_points = {'20春', '20秋', '21春', '21秋', '22春', '22秋'};

% 数据标准化
data_standardized = zscore(data);

% 进行PCA分析
[coeff, score, latent] = pca(data_standardized);

% 计算解释方差百分比
explained = (latent / sum(latent)) * 100;

% 创建PCA双标图并将线条设置为黑色
figure;
biplot(coeff(:,1:2), 'Scores', score(:,1:2), 'VarLabels', var_names, 'ObsLabels', time_points, 'LineWidth', 1.5, 'Color', 'k', 'MarkerSize', 10);

% 添加圆圈
theta = linspace(0, 2*pi, 100);
hold on;
plot(cos(theta), sin(theta), 'k--', 'LineWidth', 1.5);  % 画虚线圆圈

% 添加主箭头
for i = 1:size(coeff,1)
    quiver(0, 0, coeff(i,1), coeff(i,2), 0, 'MaxHeadSize', 0.3, 'Color', 'k', 'LineWidth', 1.5);
end

% 设置图形轴为相等
axis equal;

% 手动设置图形轴的范围到 [-1.5, 1.5]，让双标图内容更加居中
xlim([-1.5, 1.5]);
ylim([-1.5, 1.5]);

% 设置图标题和解释方差比例
title('PCA 双标图 (标准化后的数据，黑色线条)');
xlabel(['PC1 - 解释方差: ', num2str(explained(1), '%.2f'), '%']);
ylabel(['PC2 - 解释方差: ', num2str(explained(2), '%.2f'), '%']);

% 显示网格和轴线
grid on;
hold off;
