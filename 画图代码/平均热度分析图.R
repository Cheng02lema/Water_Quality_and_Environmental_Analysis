
# 加载包
library(corrplot)

# 构建数据框
data <- data.frame(
  温度 = c(9.525, 17.21785714, 25.29642857, 20.45714286, 9.039285714, 14.41428571, 27.525, 19.23214286,
         12.72857143, 26.34285714, 18.48571429, 11.43571429, 9.770588235, 16.84, 24.67142857,
         20.66842105, 9.172222222, 13.66470588, 26.45, 19.4, 12.00666667, 25.986, 18.84666667, 11.62),
  盐度 = c(32.41071429, 31.44, 30.25964286, 31.31, 31.06178571, 31.44392857, 30.67678571, 29.76678571,
         30.74964286, 29.82357143, 29.66071429, 30.20535714, 32.45117647, 31.356, 30.92428571,
         31.42526316, 31.11555556, 31.48764706, 30.930625, 29.84533333, 30.77466667, 30.31266667,
         29.89333333, 30.29466667),
  DO = c(9.057857143, 9.035714286, 5.710714286, 7.528214286, 8.792857143, 7.103571429, 7.230357143,
         7.281785714, 8.378214286, 6.19, 6.3675, 7.364285714, 8.994705882, 8.942, 5.625238095,
         7.493157895, 8.795, 7.886470588, 7.020625, 7.348666667, 8.383333333, 6.190666667, 6.438666667,
         7.518666667),
  pH = c(8.1275, 8, 8.065, 8.034285714, 8.346785714, 8.368571429, 8.183214286, 8.121071429,
         8.086071429, 8.125714286, 8.181785714, 8.163571429, 8.15, 8, 8.078571429, 8.036842105,
         8.358333333, 8.37, 8.176875, 8.072857143, 8.1, 8.13, 8.165333333, 8.167333333),
  COD = c(0.8075, 0.846428571, 0.582142857, 0.765714286, 0.528571429, 0.898571429, 0.958571429,
          0.941785714, 0.797857143, 0.828214286, 0.807857143, 0.691071429, 0.752352941, 0.67,
          0.48952381, 0.715555556, 0.555555556, 0.859411765, 0.8775, 0.827333333, 1.714,
          0.744666667, 0.714666667, 0.504666667),
  石油烃 = c(8.815714286, 1.1325, 9.505714286, 41.9325, 24.86857143, 213.3335714, 18.48785714,
          26.05428571, 9.294285714, 10.71657143, 7.86025, 5.871071429, 7.537647059, 0.908,
          11.87619048, 43.96578947, 26.74666667, 199.2070588, 14.679375, 18.986, 22.858,
          9.633333333, 7.659066667, 5.928666667),
  无机氮 = c(89.18678571, 93.08357143, 108.1914286, 121.1625, 54.14142857, 104.9385714, 37.82178571,
          62.80035714, 264.2957143, 219.0525, 150.6892857, 79.65928571, 87.64117647, 80.552,
          115.5171429, 114.9411111, 49.86333333, 111.4258824, 37.92, 69.18, 275.8686667,
          216.748, 155.468, 80.79333333),
  磷酸盐 = c(7.590357143, 8.947857143, 6.277857143, 7.881785714, 5.015357143, 7.921785714,
          19.92571429, 20.85892857, 13.09357143, 13.49821429, 10.63321429, 6.068214286, 5.287058824,
          9.698, 3.417142857, 7.188888889, 6.098888889, 8.902352941, 20.64375, 22.09466667,
          15.052, 15.06266667, 9.165333333, 6.918)
)

# 计算相关性矩阵
correlation_matrix <- cor(data, use = "complete.obs")

# 绘制相关性热图
corrplot(correlation_matrix, method = "circle", type = "full", tl.col = "black", tl.srt = 45,
         addCoef.col = "black", # 在圆圈中添加相关系数
         col = colorRampPalette(c("blue", "white", "red"))(200), # 使用蓝-白-红颜色表示相关性强弱
         number.cex = 0.8, # 控制相关系数字体大小
         mar = c(0, 0, 1, 0), # 控制边距
         title = "环境参数相关性热图")
