

# 加载包
library(corrplot)

# 创建数据框
data <- data.frame(
  年份 = c("19冬", "20春", "20夏", "20秋", "20冬", "21春", "21夏", "21秋", "22春", "22夏", "22秋", "22冬"),
  温度 = c(9.770588235, 16.84, 24.67142857, 20.66842105, 9.172222222, 13.66470588, 26.45, 19.4, 12.00666667, 25.986, 18.84666667, 11.62),
  盐度 = c(32.45117647, 31.356, 30.92428571, 31.42526316, 31.11555556, 31.48764706, 30.930625, 29.84533333, 30.77466667, 30.31266667, 29.89333333, 30.29466667),
  DO = c(8.994705882, 8.942, 5.625238095, 7.493157895, 8.795, 7.886470588, 7.020625, 7.348666667, 8.383333333, 6.190666667, 6.438666667, 7.518666667),
  pH = c(8.15, 8, 8.078571429, 8.036842105, 8.358333333, 8.37, 8.176875, 8.072857143, 8.1, 8.13, 8.165333333, 8.167333333),
  COD = c(0.752352941, 0.67, 0.48952381, 0.715555556, 0.555555556, 0.859411765, 0.8775, 0.827333333, 1.714, 0.744666667, 0.714666667, 0.504666667),
  石油烃 = c(7.537647059, 0.908, 11.87619048, 43.96578947, 26.74666667, 199.2070588, 14.679375, 18.986, 22.858, 9.633333333, 7.659066667, 5.928666667),
  无机氮 = c(87.64117647, 80.552, 115.5171429, 114.9411111, 49.86333333, 111.4258824, 37.92, 69.18, 275.8686667, 216.748, 155.468, 80.79333333),
  磷酸盐 = c(5.287058824, 9.698, 3.417142857, 7.188888889, 6.098888889, 8.902352941, 20.64375, 22.09466667, 15.052, 15.06266667, 9.165333333, 6.918)
)

# 计算相关性矩阵（排除年份列）
correlation_matrix <- cor(data[, -1])

# 绘制相关性热图，使用圆圈表示相关性，显示相关系数
corrplot(correlation_matrix, method = "circle", type = "full", tl.col = "black", tl.srt = 45,
         addCoef.col = "black", # 在圆圈中添加相关系数
         col = colorRampPalette(c("blue", "white", "red"))(200), # 使用蓝-白-红颜色表示相关性强弱
         number.cex = 0.8, # 控制相关系数字体大小
         mar = c(0, 0, 1, 0), # 控制边距
         title = "环境参数相关性表")
